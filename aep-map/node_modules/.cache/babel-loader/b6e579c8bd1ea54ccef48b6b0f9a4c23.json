{"ast":null,"code":"const UPDATE_AUTH_TOKEN = 'UPDATE_AUTH_TOKEN';\nconst authHost = process.env.REACT_APP_AUTH_HOST;\nconst appId = process.env.REACT_APP_APPID;\n\nconst parseJwt = token => {\n  try {\n    return JSON.parse(atob(token.split('.')[1]));\n  } catch (e) {\n    return null;\n  }\n};\n\nexport default {\n  name: 'auth',\n  getReducer: () => {\n    const initialState = {\n      loading: false,\n      token: null\n    };\n    return (state = initialState, {\n      type,\n      payload\n    }) => {\n      switch (type) {\n        case UPDATE_AUTH_TOKEN:\n          return { ...state,\n            ...payload\n          };\n\n        default:\n          return state;\n      }\n    };\n  },\n  doAuthFetchToken: () => ({\n    dispatch,\n    store\n  }) => {\n    fetch(`${authHost}/${appId}`, {\n      method: 'get'\n    }).then(function (response) {\n      return response.text();\n    }).then(function (data) {\n      if (parseJwt(data)) {\n        dispatch({\n          type: UPDATE_AUTH_TOKEN,\n          payload: {\n            token: data\n          }\n        });\n      }\n    });\n  },\n  selectAuthToken: state => state.auth.token\n};","map":{"version":3,"sources":["C:/Examples/aepmap/aep-map/src/app-bundles/auth-bundle.js"],"names":["UPDATE_AUTH_TOKEN","authHost","process","env","REACT_APP_AUTH_HOST","appId","REACT_APP_APPID","parseJwt","token","JSON","parse","atob","split","e","name","getReducer","initialState","loading","state","type","payload","doAuthFetchToken","dispatch","store","fetch","method","then","response","text","data","selectAuthToken","auth"],"mappings":"AAAA,MAAMA,iBAAiB,GAAG,mBAA1B;AACA,MAAMC,QAAQ,GAACC,OAAO,CAACC,GAAR,CAAYC,mBAA3B;AACA,MAAMC,KAAK,GAACH,OAAO,CAACC,GAAR,CAAYG,eAAxB;;AACA,MAAMC,QAAQ,GAAIC,KAAD,IAAW;AAC1B,MAAI;AACF,WAAOC,IAAI,CAACC,KAAL,CAAWC,IAAI,CAACH,KAAK,CAACI,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAD,CAAf,CAAP;AACD,GAFD,CAEE,OAAOC,CAAP,EAAU;AACV,WAAO,IAAP;AACD;AACF,CAND;;AAOA,eAAe;AACbC,EAAAA,IAAI,EAAE,MADO;AAEbC,EAAAA,UAAU,EAAE,MAAM;AAChB,UAAMC,YAAY,GAAG;AACnBC,MAAAA,OAAO,EAAE,KADU;AAEnBT,MAAAA,KAAK,EAAC;AAFa,KAArB;AAIA,WAAO,CAACU,KAAK,GAAGF,YAAT,EAAuB;AAAEG,MAAAA,IAAF;AAAQC,MAAAA;AAAR,KAAvB,KAA6C;AAClD,cAAOD,IAAP;AACE,aAAKnB,iBAAL;AACE,iBAAO,EAAC,GAAGkB,KAAJ;AAAU,eAAGE;AAAb,WAAP;;AACF;AACE,iBAAOF,KAAP;AAJJ;AAMD,KAPD;AAQD,GAfY;AAgBfG,EAAAA,gBAAgB,EAAC,MAAI,CAAC;AAACC,IAAAA,QAAD;AAAUC,IAAAA;AAAV,GAAD,KAAoB;AACrCC,IAAAA,KAAK,CAAE,GAAEvB,QAAS,IAAGI,KAAM,EAAtB,EAAyB;AAC1BoB,MAAAA,MAAM,EAAE;AADkB,KAAzB,CAAL,CAEGC,IAFH,CAEQ,UAASC,QAAT,EAAmB;AACvB,aAAOA,QAAQ,CAACC,IAAT,EAAP;AACH,KAJD,EAIGF,IAJH,CAIQ,UAASG,IAAT,EAAe;AACnB,UAAGtB,QAAQ,CAACsB,IAAD,CAAX,EAAkB;AACdP,QAAAA,QAAQ,CAAC;AAACH,UAAAA,IAAI,EAACnB,iBAAN;AAAwBoB,UAAAA,OAAO,EAAC;AAACZ,YAAAA,KAAK,EAACqB;AAAP;AAAhC,SAAD,CAAR;AACD;AACJ,KARH;AASC,GA1BU;AA2BXC,EAAAA,eAAe,EAACZ,KAAK,IAAEA,KAAK,CAACa,IAAN,CAAWvB;AA3BvB,CAAf","sourcesContent":["const UPDATE_AUTH_TOKEN = 'UPDATE_AUTH_TOKEN';\r\nconst authHost=process.env.REACT_APP_AUTH_HOST\r\nconst appId=process.env.REACT_APP_APPID\r\nconst parseJwt = (token) => {\r\n  try {\r\n    return JSON.parse(atob(token.split('.')[1]));\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n};\r\nexport default {\r\n  name: 'auth',\r\n  getReducer: () => {\r\n    const initialState = {\r\n      loading: false,\r\n      token:null,\r\n    }\r\n    return (state = initialState, { type, payload }) => {\r\n      switch(type){\r\n        case UPDATE_AUTH_TOKEN:\r\n          return({...state,...payload});\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n  },\r\ndoAuthFetchToken:()=>({dispatch,store})=>{\r\n    fetch(`${authHost}/${appId}`, {\r\n        method: 'get'\r\n    }).then(function(response) {\r\n        return response.text();\r\n    }).then(function(data) {\r\n        if(parseJwt(data)){\r\n            dispatch({type:UPDATE_AUTH_TOKEN,payload:{token:data}});\r\n          }\r\n      });      \r\n    },\r\n    selectAuthToken:state=>state.auth.token,\r\n  }"]},"metadata":{},"sourceType":"module"}